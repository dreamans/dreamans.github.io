import{d as r,F as c,H as e,g as o}from"./q-71956c83.js";const i=[{text:"The dollar $ sign",id:"the-dollar--sign",level:1},{text:"Compiler-time implications",id:"compiler-time-implications",level:2},{text:"Rules",id:"rules",level:2},{text:"Allowed expressions",id:"allowed-expressions",level:3},{text:"Literals without local identifiers",id:"literals-without-local-identifiers",level:4},{text:"Importable identifiers",id:"importable-identifiers",level:4},{text:"Closures",id:"closures",level:4},{text:"Captured variables must be declared as a const.",id:"captured-variables-must-be-declared-as-a-const",level:5},{text:"Local captured variables must be serializable",id:"local-captured-variables-must-be-serializable",level:5},{text:"Module-declared variables can be importable",id:"module-declared-variables-can-be-importable",level:5},{text:"Deep dive",id:"deep-dive",level:2},{text:"Symbol extraction",id:"symbol-extraction",level:2},{text:"Capturing the lexical scope",id:"capturing-the-lexical-scope",level:2}],d={title:"The $ dollar sign",meta:[],styles:[],links:[],frontmatter:{contributors:["the-r3aper7","manucorporat","adamdbradley","saikatdas0790","anthonycaron","ubmit","literalpie","forresst","mhevery","AnthonyPAlicea","zanettin"]}},D={title:"The $ dollar sign",contributors:["the-r3aper7","manucorporat","adamdbradley","saikatdas0790","anthonycaron","ubmit","literalpie","forresst","mhevery","AnthonyPAlicea","zanettin"]};function s(n){const l=Object.assign({h1:"h1",a:"a",span:"span",code:"code",p:"p",h2:"h2",div:"div",pre:"pre",blockquote:"blockquote",h3:"h3",h4:"h4",strong:"strong",ol:"ol",li:"li",h5:"h5",ul:"ul"},n.components);return e(o,{children:[e(l.h1,{id:"the-dollar--sign",children:[e(l.a,{"aria-hidden":"true",tabindex:"-1",href:"#the-dollar--sign",children:e(l.span,{class:"icon icon-link"})}),"The dollar ",e(l.code,{children:"$"})," sign"]}),`
`,e(l.p,{children:["Qwik splits up your application into many small pieces we call symbols. A component can be broken up into many symbols, so a symbol is smaller than a component. The splitting up is performed by the ",e(l.a,{href:"/docs/advanced/optimizer/",children:"Qwik Optimizer"}),"."]}),`
`,e(l.p,{children:["The ",e(l.code,{children:"$"})," suffix is used to signal both the optimizer and the developer when this transformation occurs. As a developer, you need to understand that special rules apply whenever you see ",e(l.code,{children:"$"})," (not all valid JavaScript is a valid Qwik Optimizer transform.)"]}),`
`,e(l.h2,{id:"compiler-time-implications",children:[e(l.a,{"aria-hidden":"true",tabindex:"-1",href:"#compiler-time-implications",children:e(l.span,{class:"icon icon-link"})}),"Compiler-time implications"]}),`
`,e(l.p,{children:[e(l.a,{href:"/docs/advanced/optimizer/",children:"Optimizer"})," runs as a Vite plugin during bundling. The purpose of the Optimizer is to break up the application into many small lazy-loadable chunks. The Optimizer moves expressions (usually functions) into new files and leaves behind a reference pointing to where the expression was moved from."]}),`
`,e(l.p,{children:["The ",e(l.code,{children:"$"})," tells the optimizer which functions to extract into a separate file and which ones to leave untouched. The optimizer does not keep an internal list of magic functions, instead, it solely relies on the ",e(l.code,{children:"$"})," suffix to know which functions to transform. The system is extendable and developers can create their own ",e(l.code,{children:"$"})," functions, such as ",e(l.code,{children:"myCustomFunction$()"}),"."]}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:e(l.pre,{"data-language":"tsx","data-theme":"default",children:e(l.code,{"data-language":"tsx","data-theme":"default",children:[e(l.span,{class:"line",children:[e(l.span,{style:{color:"#C586C0"},children:"import"}),e(l.span,{style:{color:"#D4D4D4"},children:" { "}),e(l.span,{style:{color:"#9CDCFE"},children:"component$"}),e(l.span,{style:{color:"#D4D4D4"},children:" } "}),e(l.span,{style:{color:"#C586C0"},children:"from"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#CE9178"},children:"'@builder.io/qwik'"}),e(l.span,{style:{color:"#D4D4D4"},children:";"})]}),`
`,e(l.span,{class:"line",children:" "}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#C586C0"},children:"export"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#C586C0"},children:"default"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#DCDCAA"},children:"component$"}),e(l.span,{style:{color:"#D4D4D4"},children:"(() "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" {"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#9CDCFE"},children:"console"}),e(l.span,{style:{color:"#D4D4D4"},children:"."}),e(l.span,{style:{color:"#DCDCAA"},children:"log"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#CE9178"},children:"'render'"}),e(l.span,{style:{color:"#D4D4D4"},children:");"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#C586C0"},children:"return"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#808080"},children:"<"}),e(l.span,{style:{color:"#569CD6"},children:"button"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#9CDCFE"},children:"onClick$"}),e(l.span,{style:{color:"#D4D4D4"},children:"="}),e(l.span,{style:{color:"#569CD6"},children:"{"}),e(l.span,{style:{color:"#D4D4D4"},children:"() "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#9CDCFE"},children:"console"}),e(l.span,{style:{color:"#D4D4D4"},children:"."}),e(l.span,{style:{color:"#DCDCAA"},children:"log"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#CE9178"},children:"'hello'"}),e(l.span,{style:{color:"#D4D4D4"},children:")"}),e(l.span,{style:{color:"#569CD6"},children:"}"}),e(l.span,{style:{color:"#808080"},children:">"}),e(l.span,{style:{color:"#D4D4D4"},children:"Hello Qwik"}),e(l.span,{style:{color:"#808080"},children:"</"}),e(l.span,{style:{color:"#569CD6"},children:"button"}),e(l.span,{style:{color:"#808080"},children:">"}),e(l.span,{style:{color:"#D4D4D4"},children:";"})]}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#D4D4D4"},children:"});"})})]})})}),`
`,e(l.p,{children:["The component above is split into multiple chunks thanks to the ",e(l.code,{children:"$"})," syntax:"]}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:[e(l.div,{"data-rehype-pretty-code-title":"","data-language":"js","data-theme":"default",children:"app.js"}),e(l.pre,{"data-language":"js","data-theme":"default",children:e(l.code,{"data-language":"js","data-theme":"default",children:[e(l.span,{class:"line",children:[e(l.span,{style:{color:"#C586C0"},children:"import"}),e(l.span,{style:{color:"#D4D4D4"},children:" { "}),e(l.span,{style:{color:"#9CDCFE"},children:"componentQrl"}),e(l.span,{style:{color:"#D4D4D4"},children:", "}),e(l.span,{style:{color:"#9CDCFE"},children:"qrl"}),e(l.span,{style:{color:"#D4D4D4"},children:" } "}),e(l.span,{style:{color:"#C586C0"},children:"from"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#CE9178"},children:"'@builder.io/qwik'"}),e(l.span,{style:{color:"#D4D4D4"},children:";"})]}),`
`,e(l.span,{class:"line",children:" "}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#4FC1FF"},children:"App"}),e(l.span,{style:{color:"#D4D4D4"},children:" = "}),e(l.span,{style:{color:"#6A9955"},children:"/*#__PURE__*/"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#DCDCAA"},children:"componentQrl"}),e(l.span,{style:{color:"#D4D4D4"},children:"("})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#DCDCAA"},children:"qrl"}),e(l.span,{style:{color:"#D4D4D4"},children:"(() "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#569CD6"},children:"import"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#CE9178"},children:"'./app_component_akbu84a8zes.js'"}),e(l.span,{style:{color:"#D4D4D4"},children:"), "}),e(l.span,{style:{color:"#CE9178"},children:"'App_component_AkbU84a8zes'"}),e(l.span,{style:{color:"#D4D4D4"},children:")"})]}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#D4D4D4"},children:");"})}),`
`,e(l.span,{class:"line",children:" "}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#C586C0"},children:"export"}),e(l.span,{style:{color:"#D4D4D4"},children:" { "}),e(l.span,{style:{color:"#9CDCFE"},children:"App"}),e(l.span,{style:{color:"#D4D4D4"},children:" };"})]})]})})]}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:[e(l.div,{"data-rehype-pretty-code-title":"","data-language":"js","data-theme":"default",children:"app_component_akbu84a8zes.js"}),e(l.pre,{"data-language":"js","data-theme":"default",children:e(l.code,{"data-language":"js","data-theme":"default",children:[e(l.span,{class:"line",children:[e(l.span,{style:{color:"#C586C0"},children:"import"}),e(l.span,{style:{color:"#D4D4D4"},children:" { "}),e(l.span,{style:{color:"#9CDCFE"},children:"jsx"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#C586C0"},children:"as"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#9CDCFE"},children:"_jsx"}),e(l.span,{style:{color:"#D4D4D4"},children:" } "}),e(l.span,{style:{color:"#C586C0"},children:"from"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#CE9178"},children:"'@builder.io/qwik/jsx-runtime'"}),e(l.span,{style:{color:"#D4D4D4"},children:";"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#C586C0"},children:"import"}),e(l.span,{style:{color:"#D4D4D4"},children:" { "}),e(l.span,{style:{color:"#9CDCFE"},children:"qrl"}),e(l.span,{style:{color:"#D4D4D4"},children:" } "}),e(l.span,{style:{color:"#C586C0"},children:"from"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#CE9178"},children:"'@builder.io/qwik'"}),e(l.span,{style:{color:"#D4D4D4"},children:";"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#C586C0"},children:"export"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#DCDCAA"},children:"App_component_AkbU84a8zes"}),e(l.span,{style:{color:"#D4D4D4"},children:" = () "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" {"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#9CDCFE"},children:"console"}),e(l.span,{style:{color:"#D4D4D4"},children:"."}),e(l.span,{style:{color:"#DCDCAA"},children:"log"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#CE9178"},children:"'render'"}),e(l.span,{style:{color:"#D4D4D4"},children:");"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#C586C0"},children:"return"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#6A9955"},children:"/*#__PURE__*/"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#DCDCAA"},children:"_jsx"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#CE9178"},children:"'p'"}),e(l.span,{style:{color:"#D4D4D4"},children:", {"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"    "}),e(l.span,{style:{color:"#9CDCFE"},children:"onClick$:"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#DCDCAA"},children:"qrl"}),e(l.span,{style:{color:"#D4D4D4"},children:"("})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"      () "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#569CD6"},children:"import"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#CE9178"},children:"'./app_component_p_onclick_01pegc10cpw'"}),e(l.span,{style:{color:"#D4D4D4"},children:"),"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"      "}),e(l.span,{style:{color:"#CE9178"},children:"'App_component_p_onClick_01pEgC10cpw'"})]}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#D4D4D4"},children:"    ),"})}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"    "}),e(l.span,{style:{color:"#9CDCFE"},children:"children:"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#CE9178"},children:"'Hello Qwik'"}),e(l.span,{style:{color:"#D4D4D4"},children:","})]}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#D4D4D4"},children:"  });"})}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#D4D4D4"},children:"};"})})]})})]}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:[e(l.div,{"data-rehype-pretty-code-title":"","data-language":"js","data-theme":"default",children:"app_component_p_onclick_01pegc10cpw.js"}),e(l.pre,{"data-language":"js","data-theme":"default",children:e(l.code,{"data-language":"js","data-theme":"default",children:e(l.span,{class:"line",children:[e(l.span,{style:{color:"#C586C0"},children:"export"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#DCDCAA"},children:"App_component_p_onClick_01pEgC10cpw"}),e(l.span,{style:{color:"#D4D4D4"},children:" = () "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#9CDCFE"},children:"console"}),e(l.span,{style:{color:"#D4D4D4"},children:"."}),e(l.span,{style:{color:"#DCDCAA"},children:"log"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#CE9178"},children:"'hello'"}),e(l.span,{style:{color:"#D4D4D4"},children:");"})]})})})]}),`
`,e(l.h2,{id:"rules",children:[e(l.a,{"aria-hidden":"true",tabindex:"-1",href:"#rules",children:e(l.span,{class:"icon icon-link"})}),"Rules"]}),`
`,e(l.p,{children:["The optimizer uses ",e(l.code,{children:"$"})," as a signal to extract the code. The developer needs to understand that the extraction comes with constraints and therefore special rules apply whenever the ",e(l.code,{children:"$"})," is present. (Not all valid JavaScript code is valid code for the Optimizer.)"]}),`
`,e(l.blockquote,{children:[`
`,e(l.p,{children:"The worst kind of code magic is the kind that's invisible to the developer."}),`
`]}),`
`,e(l.h3,{id:"allowed-expressions",children:[e(l.a,{"aria-hidden":"true",tabindex:"-1",href:"#allowed-expressions",children:e(l.span,{class:"icon icon-link"})}),"Allowed expressions"]}),`
`,e(l.p,{children:["The first argument of any function that ends with ",e(l.code,{children:"$"})," has certain restrictions:"]}),`
`,e(l.h4,{id:"literals-without-local-identifiers",children:[e(l.a,{"aria-hidden":"true",tabindex:"-1",href:"#literals-without-local-identifiers",children:e(l.span,{class:"icon icon-link"})}),"Literals without local identifiers"]}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:e(l.pre,{"data-language":"tsx","data-theme":"default",children:e(l.code,{"data-language":"tsx","data-theme":"default",children:[e(l.span,{class:"line",children:[e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#4FC1FF"},children:"bar"}),e(l.span,{style:{color:"#D4D4D4"},children:" = "}),e(l.span,{style:{color:"#CE9178"},children:"'bar'"}),e(l.span,{style:{color:"#D4D4D4"},children:";"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#4FC1FF"},children:"foo"}),e(l.span,{style:{color:"#D4D4D4"},children:" = "}),e(l.span,{style:{color:"#CE9178"},children:"'foo'"}),e(l.span,{style:{color:"#D4D4D4"},children:";"})]}),`
`,e(l.span,{class:"line",children:" "}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#6A9955"},children:"// Invalid expressions"})}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#DCDCAA"},children:"foo$"}),e(l.span,{style:{color:"#D4D4D4"},children:"({ "}),e(l.span,{style:{color:"#9CDCFE"},children:"value:"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#9CDCFE"},children:"bar"}),e(l.span,{style:{color:"#D4D4D4"},children:" }); "}),e(l.span,{style:{color:"#6A9955"},children:'// it contains a local identifier "bar"'})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#DCDCAA"},children:"foo$"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#CE9178"},children:"`Hello, "}),e(l.span,{style:{color:"#569CD6"},children:"${"}),e(l.span,{style:{color:"#9CDCFE"},children:"bar"}),e(l.span,{style:{color:"#569CD6"},children:"}"}),e(l.span,{style:{color:"#CE9178"},children:"`"}),e(l.span,{style:{color:"#D4D4D4"},children:"); "}),e(l.span,{style:{color:"#6A9955"},children:'// it contains a local identifier "bar"'})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#DCDCAA"},children:"foo$"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#9CDCFE"},children:"count"}),e(l.span,{style:{color:"#D4D4D4"},children:" + "}),e(l.span,{style:{color:"#B5CEA8"},children:"1"}),e(l.span,{style:{color:"#D4D4D4"},children:"); "}),e(l.span,{style:{color:"#6A9955"},children:'// it contains a local identifier "count"'})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#DCDCAA"},children:"foo$"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#9CDCFE"},children:"foo"}),e(l.span,{style:{color:"#D4D4D4"},children:"); "}),e(l.span,{style:{color:"#6A9955"},children:"// foo is not exported, so it's not importable"})]}),`
`,e(l.span,{class:"line",children:" "}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#6A9955"},children:"// Valid expressions"})}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#DCDCAA"},children:"foo$"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#CE9178"},children:"`Hello, bar`"}),e(l.span,{style:{color:"#D4D4D4"},children:"); "}),e(l.span,{style:{color:"#6A9955"},children:"// string literal without local identifiers"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#DCDCAA"},children:"foo$"}),e(l.span,{style:{color:"#D4D4D4"},children:"({ "}),e(l.span,{style:{color:"#9CDCFE"},children:"value:"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#CE9178"},children:"'stuff'"}),e(l.span,{style:{color:"#D4D4D4"},children:" }); "}),e(l.span,{style:{color:"#6A9955"},children:"// object literal without local identifiers"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#DCDCAA"},children:"foo$"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#B5CEA8"},children:"1"}),e(l.span,{style:{color:"#D4D4D4"},children:" + "}),e(l.span,{style:{color:"#B5CEA8"},children:"3"}),e(l.span,{style:{color:"#D4D4D4"},children:"); "}),e(l.span,{style:{color:"#6A9955"},children:"// expression without local identifiers"})]})]})})}),`
`,e(l.h4,{id:"importable-identifiers",children:[e(l.a,{"aria-hidden":"true",tabindex:"-1",href:"#importable-identifiers",children:e(l.span,{class:"icon icon-link"})}),"Importable identifiers"]}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:e(l.pre,{"data-language":"tsx","data-theme":"default",children:e(l.code,{"data-language":"tsx","data-theme":"default",children:[e(l.span,{class:"line",children:e(l.span,{style:{color:"#6A9955"},children:"// Invalid"})}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#4FC1FF"},children:"foo"}),e(l.span,{style:{color:"#D4D4D4"},children:" = "}),e(l.span,{style:{color:"#CE9178"},children:"'foo'"}),e(l.span,{style:{color:"#D4D4D4"},children:";"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#DCDCAA"},children:"foo$"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#9CDCFE"},children:"foo"}),e(l.span,{style:{color:"#D4D4D4"},children:"); "}),e(l.span,{style:{color:"#6A9955"},children:"// foo is not exported, so it's not importable"})]}),`
`,e(l.span,{class:"line",children:" "}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#6A9955"},children:"// Valid"})}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#C586C0"},children:"export"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#4FC1FF"},children:"bar"}),e(l.span,{style:{color:"#D4D4D4"},children:" = "}),e(l.span,{style:{color:"#CE9178"},children:"'bar'"}),e(l.span,{style:{color:"#D4D4D4"},children:";"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#DCDCAA"},children:"foo$"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#9CDCFE"},children:"bar"}),e(l.span,{style:{color:"#D4D4D4"},children:");"})]}),`
`,e(l.span,{class:"line",children:" "}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#6A9955"},children:"// Valid"})}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#C586C0"},children:"import"}),e(l.span,{style:{color:"#D4D4D4"},children:" { "}),e(l.span,{style:{color:"#9CDCFE"},children:"bar"}),e(l.span,{style:{color:"#D4D4D4"},children:" } "}),e(l.span,{style:{color:"#C586C0"},children:"from"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#CE9178"},children:"'./bar'"}),e(l.span,{style:{color:"#D4D4D4"},children:";"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#DCDCAA"},children:"foo$"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#9CDCFE"},children:"bar"}),e(l.span,{style:{color:"#D4D4D4"},children:");"})]})]})})}),`
`,e(l.h4,{id:"closures",children:[e(l.a,{"aria-hidden":"true",tabindex:"-1",href:"#closures",children:e(l.span,{class:"icon icon-link"})}),"Closures"]}),`
`,e(l.p,{children:"For closures, the rules are a bit relaxed, and local identifiers can be referenced and captured."}),`
`,e(l.blockquote,{children:[`
`,e(l.p,{children:[e(l.strong,{children:"RULE"}),": If a function lexically captures a variable (or parameter), that variable must be:"]}),`
`,e(l.ol,{children:[`
`,e(l.li,{children:["a ",e(l.code,{children:"const"})," and"]}),`
`,e(l.li,{children:"the value must be serializable."}),`
`]}),`
`]}),`
`,e(l.h5,{id:"captured-variables-must-be-declared-as-a-const",children:[e(l.a,{"aria-hidden":"true",tabindex:"-1",href:"#captured-variables-must-be-declared-as-a-const",children:e(l.span,{class:"icon icon-link"})}),"Captured variables must be declared as a ",e(l.code,{children:"const"}),"."]}),`
`,e(l.p,{children:e(l.strong,{children:"Invalid"})}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:e(l.pre,{"data-language":"tsx","data-theme":"default",children:e(l.code,{"data-language":"tsx","data-theme":"default",children:[e(l.span,{class:"line",children:[e(l.span,{style:{color:"#DCDCAA"},children:"component$"}),e(l.span,{style:{color:"#D4D4D4"},children:"(() "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" {"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#569CD6"},children:"let"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#9CDCFE"},children:"foo"}),e(l.span,{style:{color:"#D4D4D4"},children:" = "}),e(l.span,{style:{color:"#CE9178"},children:"'value'"}),e(l.span,{style:{color:"#D4D4D4"},children:"; "}),e(l.span,{style:{color:"#6A9955"},children:"// variable is not a const"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#C586C0"},children:"return"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#808080"},children:"<"}),e(l.span,{style:{color:"#569CD6"},children:"div"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#9CDCFE"},children:"onClick$"}),e(l.span,{style:{color:"#D4D4D4"},children:"="}),e(l.span,{style:{color:"#569CD6"},children:"{"}),e(l.span,{style:{color:"#D4D4D4"},children:"() "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#9CDCFE"},children:"console"}),e(l.span,{style:{color:"#D4D4D4"},children:"."}),e(l.span,{style:{color:"#DCDCAA"},children:"log"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#9CDCFE"},children:"foo"}),e(l.span,{style:{color:"#D4D4D4"},children:")"}),e(l.span,{style:{color:"#569CD6"},children:"}"}),e(l.span,{style:{color:"#808080"},children:"/>"})]}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#D4D4D4"},children:"});"})})]})})}),`
`,e(l.p,{children:e(l.strong,{children:"Valid"})}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:e(l.pre,{"data-language":"tsx","data-theme":"default",children:e(l.code,{"data-language":"tsx","data-theme":"default",children:[e(l.span,{class:"line",children:[e(l.span,{style:{color:"#DCDCAA"},children:"component$"}),e(l.span,{style:{color:"#D4D4D4"},children:"(() "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" {"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#4FC1FF"},children:"foo"}),e(l.span,{style:{color:"#D4D4D4"},children:" = "}),e(l.span,{style:{color:"#CE9178"},children:"'value'"}),e(l.span,{style:{color:"#D4D4D4"},children:";"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#C586C0"},children:"return"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#808080"},children:"<"}),e(l.span,{style:{color:"#569CD6"},children:"div"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#9CDCFE"},children:"onClick$"}),e(l.span,{style:{color:"#D4D4D4"},children:"="}),e(l.span,{style:{color:"#569CD6"},children:"{"}),e(l.span,{style:{color:"#D4D4D4"},children:"() "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#9CDCFE"},children:"console"}),e(l.span,{style:{color:"#D4D4D4"},children:"."}),e(l.span,{style:{color:"#DCDCAA"},children:"log"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#9CDCFE"},children:"foo"}),e(l.span,{style:{color:"#D4D4D4"},children:")"}),e(l.span,{style:{color:"#569CD6"},children:"}"}),e(l.span,{style:{color:"#808080"},children:"/>"})]}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#D4D4D4"},children:"});"})})]})})}),`
`,e(l.h5,{id:"local-captured-variables-must-be-serializable",children:[e(l.a,{"aria-hidden":"true",tabindex:"-1",href:"#local-captured-variables-must-be-serializable",children:e(l.span,{class:"icon icon-link"})}),"Local captured variables must be serializable"]}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:e(l.pre,{"data-language":"tsx","data-theme":"default",children:e(l.code,{"data-language":"tsx","data-theme":"default",children:[e(l.span,{class:"line",children:e(l.span,{style:{color:"#6A9955"},children:"// Invalid"})}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#DCDCAA"},children:"component$"}),e(l.span,{style:{color:"#D4D4D4"},children:"(() "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" {"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#4FC1FF"},children:"foo"}),e(l.span,{style:{color:"#D4D4D4"},children:" = "}),e(l.span,{style:{color:"#569CD6"},children:"new"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#DCDCAA"},children:"MyCustomClass"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#B5CEA8"},children:"12"}),e(l.span,{style:{color:"#D4D4D4"},children:"); "}),e(l.span,{style:{color:"#6A9955"},children:"// MyCustomClass is not serializable"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#C586C0"},children:"return"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#808080"},children:"<"}),e(l.span,{style:{color:"#569CD6"},children:"div"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#9CDCFE"},children:"onClick$"}),e(l.span,{style:{color:"#D4D4D4"},children:"="}),e(l.span,{style:{color:"#569CD6"},children:"{"}),e(l.span,{style:{color:"#D4D4D4"},children:"() "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#9CDCFE"},children:"console"}),e(l.span,{style:{color:"#D4D4D4"},children:"."}),e(l.span,{style:{color:"#DCDCAA"},children:"log"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#9CDCFE"},children:"foo"}),e(l.span,{style:{color:"#D4D4D4"},children:")"}),e(l.span,{style:{color:"#569CD6"},children:"}"}),e(l.span,{style:{color:"#808080"},children:"/>"})]}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#D4D4D4"},children:"});"})}),`
`,e(l.span,{class:"line",children:" "}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#6A9955"},children:"// Valid"})}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#DCDCAA"},children:"component$"}),e(l.span,{style:{color:"#D4D4D4"},children:"(() "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" {"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#4FC1FF"},children:"foo"}),e(l.span,{style:{color:"#D4D4D4"},children:" = { "}),e(l.span,{style:{color:"#9CDCFE"},children:"data:"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#B5CEA8"},children:"12"}),e(l.span,{style:{color:"#D4D4D4"},children:" };"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#C586C0"},children:"return"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#808080"},children:"<"}),e(l.span,{style:{color:"#569CD6"},children:"div"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#9CDCFE"},children:"onClick$"}),e(l.span,{style:{color:"#D4D4D4"},children:"="}),e(l.span,{style:{color:"#569CD6"},children:"{"}),e(l.span,{style:{color:"#D4D4D4"},children:"() "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#9CDCFE"},children:"console"}),e(l.span,{style:{color:"#D4D4D4"},children:"."}),e(l.span,{style:{color:"#DCDCAA"},children:"log"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#9CDCFE"},children:"foo"}),e(l.span,{style:{color:"#D4D4D4"},children:")"}),e(l.span,{style:{color:"#569CD6"},children:"}"}),e(l.span,{style:{color:"#808080"},children:"/>"})]}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#D4D4D4"},children:"});"})})]})})}),`
`,e(l.h5,{id:"module-declared-variables-can-be-importable",children:[e(l.a,{"aria-hidden":"true",tabindex:"-1",href:"#module-declared-variables-can-be-importable",children:e(l.span,{class:"icon icon-link"})}),"Module-declared variables can be importable"]}),`
`,e(l.p,{children:"If a function that is being extracted by Optimizer refers to a top-level symbol, that symbol must either be imported or exported."}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:e(l.pre,{"data-language":"tsx","data-theme":"default",children:e(l.code,{"data-language":"tsx","data-theme":"default",children:[e(l.span,{class:"line",children:e(l.span,{style:{color:"#6A9955"},children:"// Invalid"})}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#4FC1FF"},children:"foo"}),e(l.span,{style:{color:"#D4D4D4"},children:" = "}),e(l.span,{style:{color:"#569CD6"},children:"new"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#DCDCAA"},children:"MyCustomClass"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#B5CEA8"},children:"12"}),e(l.span,{style:{color:"#D4D4D4"},children:");"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#DCDCAA"},children:"component$"}),e(l.span,{style:{color:"#D4D4D4"},children:"(() "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" {"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#6A9955"},children:"// Foo is declared at the module level, but it's not exported"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#9CDCFE"},children:"console"}),e(l.span,{style:{color:"#D4D4D4"},children:"."}),e(l.span,{style:{color:"#DCDCAA"},children:"log"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#9CDCFE"},children:"foo"}),e(l.span,{style:{color:"#D4D4D4"},children:");"})]}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#D4D4D4"},children:"});"})}),`
`,e(l.span,{class:"line",children:" "}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#6A9955"},children:"// Valid"})}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#C586C0"},children:"export"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#4FC1FF"},children:"foo"}),e(l.span,{style:{color:"#D4D4D4"},children:" = "}),e(l.span,{style:{color:"#569CD6"},children:"new"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#DCDCAA"},children:"MyCustomClass"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#B5CEA8"},children:"12"}),e(l.span,{style:{color:"#D4D4D4"},children:");"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#DCDCAA"},children:"component$"}),e(l.span,{style:{color:"#D4D4D4"},children:"(() "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" {"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#9CDCFE"},children:"console"}),e(l.span,{style:{color:"#D4D4D4"},children:"."}),e(l.span,{style:{color:"#DCDCAA"},children:"log"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#9CDCFE"},children:"foo"}),e(l.span,{style:{color:"#D4D4D4"},children:");"})]}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#D4D4D4"},children:"});"})}),`
`,e(l.span,{class:"line",children:" "}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#6A9955"},children:"// Valid"})}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#C586C0"},children:"import"}),e(l.span,{style:{color:"#D4D4D4"},children:" { "}),e(l.span,{style:{color:"#9CDCFE"},children:"foo"}),e(l.span,{style:{color:"#D4D4D4"},children:" } "}),e(l.span,{style:{color:"#C586C0"},children:"from"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#CE9178"},children:"'./foo'"}),e(l.span,{style:{color:"#D4D4D4"},children:";"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#DCDCAA"},children:"component$"}),e(l.span,{style:{color:"#D4D4D4"},children:"(() "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" {"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#9CDCFE"},children:"console"}),e(l.span,{style:{color:"#D4D4D4"},children:"."}),e(l.span,{style:{color:"#DCDCAA"},children:"log"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#9CDCFE"},children:"foo"}),e(l.span,{style:{color:"#D4D4D4"},children:");"})]}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#D4D4D4"},children:"});"})})]})})}),`
`,e(l.h2,{id:"deep-dive",children:[e(l.a,{"aria-hidden":"true",tabindex:"-1",href:"#deep-dive",children:e(l.span,{class:"icon icon-link"})}),"Deep dive"]}),`
`,e(l.p,{children:"Let's look at the hypothetical problem of acting on a scroll event. You may be tempted to write the code like so:"}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:e(l.pre,{"data-language":"tsx","data-theme":"default",children:e(l.code,{"data-language":"tsx","data-theme":"default",children:[e(l.span,{class:"line",children:[e(l.span,{style:{color:"#569CD6"},children:"function"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#DCDCAA"},children:"onScroll"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#DCDCAA"},children:"fn"}),e(l.span,{style:{color:"#D4D4D4"},children:": () "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#4EC9B0"},children:"void"}),e(l.span,{style:{color:"#D4D4D4"},children:") {"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#9CDCFE"},children:"document"}),e(l.span,{style:{color:"#D4D4D4"},children:"."}),e(l.span,{style:{color:"#DCDCAA"},children:"addEventListener"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#CE9178"},children:"'scroll'"}),e(l.span,{style:{color:"#D4D4D4"},children:", "}),e(l.span,{style:{color:"#9CDCFE"},children:"fn"}),e(l.span,{style:{color:"#D4D4D4"},children:");"})]}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#D4D4D4"},children:"}"})}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#DCDCAA"},children:"onScroll"}),e(l.span,{style:{color:"#D4D4D4"},children:"(() "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#DCDCAA"},children:"alert"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#CE9178"},children:"'scroll'"}),e(l.span,{style:{color:"#D4D4D4"},children:"));"})]})]})})}),`
`,e(l.p,{children:"The problem with this approach is that the event handler is eagerly loaded, even if the scroll event never triggers. What is needed is a way to refer to code in a lazy loadable way."}),`
`,e(l.p,{children:"The developer could write:"}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:e(l.pre,{"data-language":"tsx","data-theme":"default",children:e(l.code,{"data-language":"tsx","data-theme":"default",children:[e(l.span,{class:"line",children:[e(l.span,{style:{color:"#C586C0"},children:"export"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#9CDCFE"},children:"scrollHandler"}),e(l.span,{style:{color:"#D4D4D4"},children:" = () => "}),e(l.span,{style:{color:"#9CDCFE"},children:"alert"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#CE9178"},children:"'scroll'"}),e(l.span,{style:{color:"#D4D4D4"},children:");"})]}),`
`,e(l.span,{class:"line",children:" "}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#DCDCAA"},children:"onScroll"}),e(l.span,{style:{color:"#D4D4D4"},children:"(() "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" ("}),e(l.span,{style:{color:"#C586C0"},children:"await"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#569CD6"},children:"import"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#CE9178"},children:"'./some-chunk'"}),e(l.span,{style:{color:"#D4D4D4"},children:"))."}),e(l.span,{style:{color:"#DCDCAA"},children:"scrollHandler"}),e(l.span,{style:{color:"#D4D4D4"},children:"());"})]})]})})}),`
`,e(l.p,{children:["This works but is a lot of work. The developer is responsible for putting the code in a different file and hard coding the chunk name. Instead, we use Optimizer to perform the work for us automatically. But we need a way to tell Optimizer that we want to perform such a refactoring. We use ",e(l.code,{children:"$()"})," as a marker function for this purpose."]}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:e(l.pre,{"data-language":"tsx","data-theme":"default",children:e(l.code,{"data-language":"tsx","data-theme":"default",children:[e(l.span,{class:"line",children:[e(l.span,{style:{color:"#569CD6"},children:"function"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#DCDCAA"},children:"onScroll"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#9CDCFE"},children:"fnQrl"}),e(l.span,{style:{color:"#D4D4D4"},children:": "}),e(l.span,{style:{color:"#4EC9B0"},children:"QRL"}),e(l.span,{style:{color:"#D4D4D4"},children:"<() "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#4EC9B0"},children:"void"}),e(l.span,{style:{color:"#D4D4D4"},children:">) {"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#9CDCFE"},children:"document"}),e(l.span,{style:{color:"#D4D4D4"},children:"."}),e(l.span,{style:{color:"#DCDCAA"},children:"addEventListener"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#CE9178"},children:"'scroll'"}),e(l.span,{style:{color:"#D4D4D4"},children:", "}),e(l.span,{style:{color:"#569CD6"},children:"async"}),e(l.span,{style:{color:"#D4D4D4"},children:" () "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" {"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"    "}),e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#4FC1FF"},children:"fn"}),e(l.span,{style:{color:"#D4D4D4"},children:" = "}),e(l.span,{style:{color:"#C586C0"},children:"await"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#9CDCFE"},children:"fnQrl"}),e(l.span,{style:{color:"#D4D4D4"},children:"."}),e(l.span,{style:{color:"#DCDCAA"},children:"resolve"}),e(l.span,{style:{color:"#D4D4D4"},children:"();"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"    "}),e(l.span,{style:{color:"#DCDCAA"},children:"fn"}),e(l.span,{style:{color:"#D4D4D4"},children:"();"})]}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#D4D4D4"},children:"  });"})}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#D4D4D4"},children:"}"})}),`
`,e(l.span,{class:"line",children:" "}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#DCDCAA"},children:"onScroll"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#DCDCAA"},children:"$"}),e(l.span,{style:{color:"#D4D4D4"},children:"(() "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#DCDCAA"},children:"alert"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#CE9178"},children:"'clicked'"}),e(l.span,{style:{color:"#D4D4D4"},children:")));"})]})]})})}),`
`,e(l.p,{children:"The Optimizer will generate:"}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:e(l.pre,{"data-language":"tsx","data-theme":"default",children:e(l.code,{"data-language":"tsx","data-theme":"default",children:e(l.span,{class:"line",children:[e(l.span,{style:{color:"#DCDCAA"},children:"onScroll"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#DCDCAA"},children:"qrl"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#CE9178"},children:"'./chunk-a.js'"}),e(l.span,{style:{color:"#D4D4D4"},children:", "}),e(l.span,{style:{color:"#CE9178"},children:"'onScroll_1'"}),e(l.span,{style:{color:"#D4D4D4"},children:"));"})]})})})}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:[e(l.div,{"data-rehype-pretty-code-title":"","data-language":"tsx","data-theme":"default",children:"chunk-a.js"}),e(l.pre,{"data-language":"tsx","data-theme":"default",children:e(l.code,{"data-language":"tsx","data-theme":"default",children:e(l.span,{class:"line",children:[e(l.span,{style:{color:"#C586C0"},children:"export"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#DCDCAA"},children:"onScroll_1"}),e(l.span,{style:{color:"#D4D4D4"},children:" = () "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#DCDCAA"},children:"alert"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#CE9178"},children:"'scroll'"}),e(l.span,{style:{color:"#D4D4D4"},children:");"})]})})})]}),`
`,e(l.ol,{children:[`
`,e(l.li,{children:["All that the developer had to do was to wrap the function in the ",e(l.code,{children:"$()"})," to signal to the Optimizer that the function should be moved to a new file and therefore be lazy-loaded."]}),`
`,e(l.li,{children:["The ",e(l.code,{children:"onScroll"})," function had to be implemented slightly differently as it needs to take into account the fact that the ",e(l.code,{children:"QRL"})," of the function needs to be loaded before it can be used. In practice using ",e(l.code,{children:"QRL.resolve()"})," is rare in Qwik applications as the Qwik framework provides higher-level APIs that rarely expect the developer to work with ",e(l.code,{children:"QRL.resolve()"})," directly."]}),`
`]}),`
`,e(l.p,{children:["However, wrapping code in ",e(l.code,{children:"$()"})," is a bit inconvenient. For this reason, one can use ",e(l.code,{children:"implicit$FirstArg()"})," to automatically perform the wrapping and type matching of the function taking the ",e(l.code,{children:"QRL"}),". The function passed into ",e(l.code,{children:"implicit$FirstArg()"})," should have a suffix of ",e(l.code,{children:"Qrl"}),", and the result of that function should be set to a value with a suffix of ",e(l.code,{children:"$"}),";"]}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:e(l.pre,{"data-language":"tsx","data-theme":"default",children:e(l.code,{"data-language":"tsx","data-theme":"default",children:[e(l.span,{class:"line",children:[e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#4FC1FF"},children:"onScroll$"}),e(l.span,{style:{color:"#D4D4D4"},children:" = "}),e(l.span,{style:{color:"#DCDCAA"},children:"implicit$FirstArg"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#9CDCFE"},children:"onScrollQrl"}),e(l.span,{style:{color:"#D4D4D4"},children:");"})]}),`
`,e(l.span,{class:"line",children:" "}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#DCDCAA"},children:"onScroll$"}),e(l.span,{style:{color:"#D4D4D4"},children:"(() "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#DCDCAA"},children:"alert"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#CE9178"},children:"'scroll'"}),e(l.span,{style:{color:"#D4D4D4"},children:"));"})]})]})})}),`
`,e(l.p,{children:"Now the developer has an easy syntax for expressing that a particular function should be lazy-loaded."}),`
`,e(l.h2,{id:"symbol-extraction",children:[e(l.a,{"aria-hidden":"true",tabindex:"-1",href:"#symbol-extraction",children:e(l.span,{class:"icon icon-link"})}),"Symbol extraction"]}),`
`,e(l.p,{children:"Assume that you have this code:"}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:e(l.pre,{"data-language":"tsx","data-theme":"default",children:e(l.code,{"data-language":"tsx","data-theme":"default",children:[e(l.span,{class:"line",children:[e(l.span,{style:{color:"#C586C0"},children:"export"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#4FC1FF"},children:"MyComp"}),e(l.span,{style:{color:"#D4D4D4"},children:" = "}),e(l.span,{style:{color:"#DCDCAA"},children:"component$"}),e(l.span,{style:{color:"#D4D4D4"},children:"(() "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" {"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#6A9955"},children:"/* my component definition */"})]}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#D4D4D4"},children:"});"})})]})})}),`
`,e(l.p,{children:"The Optimizer breaks the code up into two files:"}),`
`,e(l.p,{children:"The original file:"}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:e(l.pre,{"data-language":"tsx","data-theme":"default",children:e(l.code,{"data-language":"tsx","data-theme":"default",children:e(l.span,{class:"line",children:[e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#4FC1FF"},children:"MyComp"}),e(l.span,{style:{color:"#D4D4D4"},children:" = "}),e(l.span,{style:{color:"#DCDCAA"},children:"component"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#DCDCAA"},children:"qrl"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#CE9178"},children:"'./chunk-a.js'"}),e(l.span,{style:{color:"#D4D4D4"},children:", "}),e(l.span,{style:{color:"#CE9178"},children:"'MyComp_onMount'"}),e(l.span,{style:{color:"#D4D4D4"},children:"));"})]})})})}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:[e(l.div,{"data-rehype-pretty-code-title":"","data-language":"tsx","data-theme":"default",children:"chunk-a.js"}),e(l.pre,{"data-language":"tsx","data-theme":"default",children:e(l.code,{"data-language":"tsx","data-theme":"default",children:[e(l.span,{class:"line",children:[e(l.span,{style:{color:"#C586C0"},children:"export"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#DCDCAA"},children:"MyComp_onMount"}),e(l.span,{style:{color:"#D4D4D4"},children:" = () "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" {"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#6A9955"},children:"/* my component definition */"})]}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#D4D4D4"},children:"};"})})]})})]}),`
`,e(l.p,{children:["The result of Optimizer is that the ",e(l.code,{children:"MyComp"}),"'s ",e(l.code,{children:"onMount"})," method was extracted into a new file. There are a few benefits to doing this:"]}),`
`,e(l.ul,{children:[`
`,e(l.li,{children:["A Parent component can refer to ",e(l.code,{children:"MyComp"})," without pulling in ",e(l.code,{children:"MyComp"})," implementation details."]}),`
`,e(l.li,{children:"The application now has more entry points, giving the bundler more ways to chunk up the codebase."}),`
`]}),`
`,e(l.h2,{id:"capturing-the-lexical-scope",children:[e(l.a,{"aria-hidden":"true",tabindex:"-1",href:"#capturing-the-lexical-scope",children:e(l.span,{class:"icon icon-link"})}),"Capturing the lexical scope"]}),`
`,e(l.p,{children:["The Optimizer extracts expressions (usually functions) into new files and leaves behind a ",e(l.code,{children:"QRL"})," pointing to the lazy-loaded location."]}),`
`,e(l.p,{children:"Let's look at a simple case:"}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:e(l.pre,{"data-language":"tsx","data-theme":"default",children:e(l.code,{"data-language":"tsx","data-theme":"default",children:[e(l.span,{class:"line",children:[e(l.span,{style:{color:"#C586C0"},children:"export"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#4FC1FF"},children:"Greeter"}),e(l.span,{style:{color:"#D4D4D4"},children:" = "}),e(l.span,{style:{color:"#DCDCAA"},children:"component$"}),e(l.span,{style:{color:"#D4D4D4"},children:"(() "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" {"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#C586C0"},children:"return"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#808080"},children:"<"}),e(l.span,{style:{color:"#569CD6"},children:"div"}),e(l.span,{style:{color:"#808080"},children:">"}),e(l.span,{style:{color:"#D4D4D4"},children:"Hello World!"}),e(l.span,{style:{color:"#808080"},children:"</"}),e(l.span,{style:{color:"#569CD6"},children:"div"}),e(l.span,{style:{color:"#808080"},children:">"}),e(l.span,{style:{color:"#D4D4D4"},children:";"})]}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#D4D4D4"},children:"});"})})]})})}),`
`,e(l.p,{children:"this will result in:"}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:e(l.pre,{"data-language":"tsx","data-theme":"default",children:e(l.code,{"data-language":"tsx","data-theme":"default",children:e(l.span,{class:"line",children:[e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#4FC1FF"},children:"Greeter"}),e(l.span,{style:{color:"#D4D4D4"},children:" = "}),e(l.span,{style:{color:"#DCDCAA"},children:"component"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#DCDCAA"},children:"qrl"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#CE9178"},children:"'./chunk-a.js'"}),e(l.span,{style:{color:"#D4D4D4"},children:", "}),e(l.span,{style:{color:"#CE9178"},children:"'Greeter_onMount'"}),e(l.span,{style:{color:"#D4D4D4"},children:"));"})]})})})}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:[e(l.div,{"data-rehype-pretty-code-title":"","data-language":"tsx","data-theme":"default",children:"chunk-a.js"}),e(l.pre,{"data-language":"tsx","data-theme":"default",children:e(l.code,{"data-language":"tsx","data-theme":"default",children:[e(l.span,{class:"line",children:[e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#DCDCAA"},children:"Greeter_onMount"}),e(l.span,{style:{color:"#D4D4D4"},children:" = () "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" {"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#C586C0"},children:"return"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#DCDCAA"},children:"qrl"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#CE9178"},children:"'./chunk-b.js'"}),e(l.span,{style:{color:"#D4D4D4"},children:", "}),e(l.span,{style:{color:"#CE9178"},children:"'Greeter_onRender'"}),e(l.span,{style:{color:"#D4D4D4"},children:");"})]}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#D4D4D4"},children:"};"})})]})})]}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:[e(l.div,{"data-rehype-pretty-code-title":"","data-language":"tsx","data-theme":"default",children:"chunk-b.js"}),e(l.pre,{"data-language":"tsx","data-theme":"default",children:e(l.code,{"data-language":"tsx","data-theme":"default",children:e(l.span,{class:"line",children:[e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#DCDCAA"},children:"Greeter_onRender"}),e(l.span,{style:{color:"#D4D4D4"},children:" = () "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#808080"},children:"<"}),e(l.span,{style:{color:"#569CD6"},children:"span"}),e(l.span,{style:{color:"#808080"},children:">"}),e(l.span,{style:{color:"#D4D4D4"},children:"Hello World!"}),e(l.span,{style:{color:"#808080"},children:"</"}),e(l.span,{style:{color:"#569CD6"},children:"span"}),e(l.span,{style:{color:"#808080"},children:">"}),e(l.span,{style:{color:"#D4D4D4"},children:";"})]})})})]}),`
`,e(l.p,{children:"The above is for simple cases where the extracted function closure does not capture any variables. Let's look at a more complicated case where the extracted function closure lexically captures variables."}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:e(l.pre,{"data-language":"tsx","data-theme":"default",children:e(l.code,{"data-language":"tsx","data-theme":"default",children:[e(l.span,{class:"line",children:[e(l.span,{style:{color:"#C586C0"},children:"export"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#4FC1FF"},children:"Greeter"}),e(l.span,{style:{color:"#D4D4D4"},children:" = "}),e(l.span,{style:{color:"#DCDCAA"},children:"component$"}),e(l.span,{style:{color:"#D4D4D4"},children:"(("}),e(l.span,{style:{color:"#9CDCFE"},children:"props"}),e(l.span,{style:{color:"#D4D4D4"},children:": { "}),e(l.span,{style:{color:"#9CDCFE"},children:"name"}),e(l.span,{style:{color:"#D4D4D4"},children:": "}),e(l.span,{style:{color:"#4EC9B0"},children:"string"}),e(l.span,{style:{color:"#D4D4D4"},children:" }) "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" {"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#4FC1FF"},children:"salutation"}),e(l.span,{style:{color:"#D4D4D4"},children:" = "}),e(l.span,{style:{color:"#CE9178"},children:"'Hello'"}),e(l.span,{style:{color:"#D4D4D4"},children:";"})]}),`
`,e(l.span,{class:"line",children:" "}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#C586C0"},children:"return"}),e(l.span,{style:{color:"#D4D4D4"},children:" ("})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"    "}),e(l.span,{style:{color:"#808080"},children:"<"}),e(l.span,{style:{color:"#569CD6"},children:"div"}),e(l.span,{style:{color:"#808080"},children:">"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"      "}),e(l.span,{style:{color:"#569CD6"},children:"{"}),e(l.span,{style:{color:"#9CDCFE"},children:"salutation"}),e(l.span,{style:{color:"#569CD6"},children:"}"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#569CD6"},children:"{"}),e(l.span,{style:{color:"#9CDCFE"},children:"props"}),e(l.span,{style:{color:"#D4D4D4"},children:"."}),e(l.span,{style:{color:"#9CDCFE"},children:"name"}),e(l.span,{style:{color:"#569CD6"},children:"}"}),e(l.span,{style:{color:"#D4D4D4"},children:"!"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"    "}),e(l.span,{style:{color:"#808080"},children:"</"}),e(l.span,{style:{color:"#569CD6"},children:"div"}),e(l.span,{style:{color:"#808080"},children:">"})]}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#D4D4D4"},children:"  );"})}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#D4D4D4"},children:"});"})})]})})}),`
`,e(l.p,{children:"The naive way to extract functions will not work."}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:e(l.pre,{"data-language":"tsx","data-theme":"default",children:e(l.code,{"data-language":"tsx","data-theme":"default",children:e(l.span,{class:"line",children:[e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#4FC1FF"},children:"Greeter"}),e(l.span,{style:{color:"#D4D4D4"},children:" = "}),e(l.span,{style:{color:"#DCDCAA"},children:"component"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#DCDCAA"},children:"qrl"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#CE9178"},children:"'./chunk-a.js'"}),e(l.span,{style:{color:"#D4D4D4"},children:", "}),e(l.span,{style:{color:"#CE9178"},children:"'Greeter_onMount'"}),e(l.span,{style:{color:"#D4D4D4"},children:"));"})]})})})}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:[e(l.div,{"data-rehype-pretty-code-title":"","data-language":"tsx","data-theme":"default",children:"chunk-a.js"}),e(l.pre,{"data-language":"tsx","data-theme":"default",children:e(l.code,{"data-language":"tsx","data-theme":"default",children:[e(l.span,{class:"line",children:[e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#DCDCAA"},children:"Greeter_onMount"}),e(l.span,{style:{color:"#D4D4D4"},children:" = ("}),e(l.span,{style:{color:"#9CDCFE"},children:"props"}),e(l.span,{style:{color:"#D4D4D4"},children:") "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" {"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#4FC1FF"},children:"salutation"}),e(l.span,{style:{color:"#D4D4D4"},children:" = "}),e(l.span,{style:{color:"#CE9178"},children:"'Hello'"}),e(l.span,{style:{color:"#D4D4D4"},children:";"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#C586C0"},children:"return"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#DCDCAA"},children:"qrl"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#CE9178"},children:"'./chunk-b.js'"}),e(l.span,{style:{color:"#D4D4D4"},children:", "}),e(l.span,{style:{color:"#CE9178"},children:"'Greeter_onRender'"}),e(l.span,{style:{color:"#D4D4D4"},children:");"})]}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#D4D4D4"},children:"};"})})]})})]}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:[e(l.div,{"data-rehype-pretty-code-title":"","data-language":"tsx","data-theme":"default",children:"chunk-b.js"}),e(l.pre,{"data-language":"tsx","data-theme":"default",children:e(l.code,{"data-language":"tsx","data-theme":"default",children:[e(l.span,{class:"line",children:[e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#DCDCAA"},children:"Greeter_onRender"}),e(l.span,{style:{color:"#D4D4D4"},children:" = () "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" ("})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#808080"},children:"<"}),e(l.span,{style:{color:"#569CD6"},children:"div"}),e(l.span,{style:{color:"#808080"},children:">"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"    "}),e(l.span,{style:{color:"#569CD6"},children:"{"}),e(l.span,{style:{color:"#9CDCFE"},children:"salutation"}),e(l.span,{style:{color:"#569CD6"},children:"}"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#569CD6"},children:"{"}),e(l.span,{style:{color:"#9CDCFE"},children:"props"}),e(l.span,{style:{color:"#D4D4D4"},children:"."}),e(l.span,{style:{color:"#9CDCFE"},children:"name"}),e(l.span,{style:{color:"#569CD6"},children:"}"}),e(l.span,{style:{color:"#D4D4D4"},children:"!"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#808080"},children:"</"}),e(l.span,{style:{color:"#569CD6"},children:"div"}),e(l.span,{style:{color:"#808080"},children:">"})]}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#D4D4D4"},children:");"})})]})})]}),`
`,e(l.p,{children:["The issue can be seen in ",e(l.code,{children:"chunk-b.js"}),". The extracted function refers to ",e(l.code,{children:"salutation"})," and ",e(l.code,{children:"props"}),", which are no longer in the lexical scope of the function. For this reason, the generated code must be slightly different."]}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:[e(l.div,{"data-rehype-pretty-code-title":"","data-language":"tsx","data-theme":"default",children:"chunk-a.js"}),e(l.pre,{"data-language":"tsx","data-theme":"default",children:e(l.code,{"data-language":"tsx","data-theme":"default",children:[e(l.span,{class:"line",children:[e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#DCDCAA"},children:"Greeter_onMount"}),e(l.span,{style:{color:"#D4D4D4"},children:" = ("}),e(l.span,{style:{color:"#9CDCFE"},children:"props"}),e(l.span,{style:{color:"#D4D4D4"},children:") "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" {"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#4FC1FF"},children:"salutation"}),e(l.span,{style:{color:"#D4D4D4"},children:" = "}),e(l.span,{style:{color:"#CE9178"},children:"'Hello'"}),e(l.span,{style:{color:"#D4D4D4"},children:";"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#C586C0"},children:"return"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#DCDCAA"},children:"qrl"}),e(l.span,{style:{color:"#D4D4D4"},children:"("}),e(l.span,{style:{color:"#CE9178"},children:"'./chunk-b.js'"}),e(l.span,{style:{color:"#D4D4D4"},children:", "}),e(l.span,{style:{color:"#CE9178"},children:"'Greeter_onRender'"}),e(l.span,{style:{color:"#D4D4D4"},children:", ["}),e(l.span,{style:{color:"#9CDCFE"},children:"salutation"}),e(l.span,{style:{color:"#D4D4D4"},children:", "}),e(l.span,{style:{color:"#9CDCFE"},children:"props"}),e(l.span,{style:{color:"#D4D4D4"},children:"]);"})]}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#D4D4D4"},children:"};"})})]})})]}),`
`,e(l.div,{"data-rehype-pretty-code-fragment":"",children:[e(l.div,{"data-rehype-pretty-code-title":"","data-language":"tsx","data-theme":"default",children:"chunk-b.js"}),e(l.pre,{"data-language":"tsx","data-theme":"default",children:e(l.code,{"data-language":"tsx","data-theme":"default",children:[e(l.span,{class:"line",children:[e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#DCDCAA"},children:"Greeter_onRender"}),e(l.span,{style:{color:"#D4D4D4"},children:" = () "}),e(l.span,{style:{color:"#569CD6"},children:"=>"}),e(l.span,{style:{color:"#D4D4D4"},children:" {"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#569CD6"},children:"const"}),e(l.span,{style:{color:"#D4D4D4"},children:" ["}),e(l.span,{style:{color:"#4FC1FF"},children:"salutation"}),e(l.span,{style:{color:"#D4D4D4"},children:", "}),e(l.span,{style:{color:"#4FC1FF"},children:"props"}),e(l.span,{style:{color:"#D4D4D4"},children:"] = "}),e(l.span,{style:{color:"#DCDCAA"},children:"useLexicalScope"}),e(l.span,{style:{color:"#D4D4D4"},children:"();"})]}),`
`,e(l.span,{class:"line",children:" "}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"  "}),e(l.span,{style:{color:"#C586C0"},children:"return"}),e(l.span,{style:{color:"#D4D4D4"},children:" ("})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"    "}),e(l.span,{style:{color:"#808080"},children:"<"}),e(l.span,{style:{color:"#569CD6"},children:"div"}),e(l.span,{style:{color:"#808080"},children:">"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"      "}),e(l.span,{style:{color:"#569CD6"},children:"{"}),e(l.span,{style:{color:"#9CDCFE"},children:"salutation"}),e(l.span,{style:{color:"#569CD6"},children:"}"}),e(l.span,{style:{color:"#D4D4D4"},children:" "}),e(l.span,{style:{color:"#569CD6"},children:"{"}),e(l.span,{style:{color:"#9CDCFE"},children:"props"}),e(l.span,{style:{color:"#D4D4D4"},children:"."}),e(l.span,{style:{color:"#9CDCFE"},children:"name"}),e(l.span,{style:{color:"#569CD6"},children:"}"}),e(l.span,{style:{color:"#D4D4D4"},children:"!"})]}),`
`,e(l.span,{class:"line",children:[e(l.span,{style:{color:"#D4D4D4"},children:"    "}),e(l.span,{style:{color:"#808080"},children:"</"}),e(l.span,{style:{color:"#569CD6"},children:"div"}),e(l.span,{style:{color:"#808080"},children:">"})]}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#D4D4D4"},children:"  );"})}),`
`,e(l.span,{class:"line",children:e(l.span,{style:{color:"#D4D4D4"},children:"};"})})]})})]}),`
`,e(l.p,{children:"Notice two changes:"}),`
`,e(l.ol,{children:[`
`,e(l.li,{children:["The ",e(l.code,{children:"QRL"})," in ",e(l.code,{children:"Greeter_onMount"})," now stores the ",e(l.code,{children:"salutation"})," and ",e(l.code,{children:"props"}),". This performs the role of capturing the constants inside closures."]}),`
`,e(l.li,{children:["The generated closure ",e(l.code,{children:"Greeter_onRender"})," now has a preamble which restores the ",e(l.code,{children:"salutation"})," and ",e(l.code,{children:"props"})," (",e(l.code,{children:"const [salutation, props] = useLexicalScope()"}),".)"]}),`
`]}),`
`,e(l.p,{children:"The ability for the Optimizer (and Qwik runtime) to capture lexically scoped constants significantly improves which functions can be extracted into lazy-loaded resources. It is a powerful tool for breaking up complex applications into smaller lazy-loadable chunks."})]})}function a(n={}){const{wrapper:l}=n.components||{};return l?e(l,Object.assign({},n,{children:e(s,n)})):s(n)}const h=()=>r(c,{children:r(a,{},3,null)},3,"BdRVprq_");export{h as default,D as frontmatter,d as head,i as headings};
