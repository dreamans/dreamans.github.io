import{d as s,F as c,H as n,g as o}from"./q-71956c83.js";const t=[{text:"$ Boundaries",id:"-boundaries",level:1},{text:"Rules",id:"rules",level:2},{text:"Serialization Boundary",id:"serialization-boundary",level:2}],D={title:"Serialization & Serialization Boundaries",meta:[],styles:[],links:[],frontmatter:{contributors:["fabien0102","wuweiweiwu","manucorporat","adamdbradley","voluntadpear"]}},d={title:"Serialization & Serialization Boundaries",contributors:["fabien0102","wuweiweiwu","manucorporat","adamdbradley","voluntadpear"]};function r(e){const l=Object.assign({h1:"h1",a:"a",span:"span",code:"code",h2:"h2",ul:"ul",li:"li",p:"p",div:"div",pre:"pre"},e.components);return n(o,{children:[n(l.h1,{id:"-boundaries",children:[n(l.a,{"aria-hidden":"true",tabindex:"-1",href:"#-boundaries",children:n(l.span,{class:"icon icon-link"})}),n(l.code,{children:"$"})," Boundaries"]}),`
`,n(l.h2,{id:"rules",children:[n(l.a,{"aria-hidden":"true",tabindex:"-1",href:"#rules",children:n(l.span,{class:"icon icon-link"})}),"Rules"]}),`
`,n(l.ul,{children:[`
`,n(l.li,{children:["Only serializable data can cross a ",n(l.code,{children:"$"})," boundary."]}),`
`]}),`
`,n(l.h2,{id:"serialization-boundary",children:[n(l.a,{"aria-hidden":"true",tabindex:"-1",href:"#serialization-boundary",children:n(l.span,{class:"icon icon-link"})}),"Serialization Boundary"]}),`
`,n(l.p,{children:["A serialization boundary occurs whenever you cross a lexical scope of a function that is converted into lazy loadable form. It is always denoted by ",n(l.code,{children:"$(...)"})," (or ",n(l.code,{children:"____$(...)"}),") See example:"]}),`
`,n(l.div,{"data-rehype-pretty-code-fragment":"",children:n(l.pre,{"data-language":"tsx","data-theme":"default",children:n(l.code,{"data-language":"tsx","data-theme":"default",children:[n(l.span,{class:"line",children:[n(l.span,{style:{color:"#C586C0"},children:"import"}),n(l.span,{style:{color:"#D4D4D4"},children:" { "}),n(l.span,{style:{color:"#9CDCFE"},children:"component$"}),n(l.span,{style:{color:"#D4D4D4"},children:" } "}),n(l.span,{style:{color:"#C586C0"},children:"from"}),n(l.span,{style:{color:"#D4D4D4"},children:" "}),n(l.span,{style:{color:"#CE9178"},children:"'@builder.io/qwik'"}),n(l.span,{style:{color:"#D4D4D4"},children:";"})]}),`
`,n(l.span,{class:"line",children:" "}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#C586C0"},children:"export"}),n(l.span,{style:{color:"#D4D4D4"},children:" "}),n(l.span,{style:{color:"#569CD6"},children:"const"}),n(l.span,{style:{color:"#D4D4D4"},children:" "}),n(l.span,{style:{color:"#4FC1FF"},children:"topLevel"}),n(l.span,{style:{color:"#D4D4D4"},children:" = "}),n(l.span,{style:{color:"#4EC9B0"},children:"Promise"}),n(l.span,{style:{color:"#D4D4D4"},children:"."}),n(l.span,{style:{color:"#DCDCAA"},children:"resolve"}),n(l.span,{style:{color:"#D4D4D4"},children:"("}),n(l.span,{style:{color:"#CE9178"},children:"'nonserializable data'"}),n(l.span,{style:{color:"#D4D4D4"},children:");"})]}),`
`,n(l.span,{class:"line",children:" "}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#C586C0"},children:"export"}),n(l.span,{style:{color:"#D4D4D4"},children:" "}),n(l.span,{style:{color:"#569CD6"},children:"class"}),n(l.span,{style:{color:"#D4D4D4"},children:" "}),n(l.span,{style:{color:"#4EC9B0"},children:"MyCustomClass"}),n(l.span,{style:{color:"#D4D4D4"},children:" {"})]}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"  "}),n(l.span,{style:{color:"#9CDCFE"},children:"val"}),n(l.span,{style:{color:"#D4D4D4"},children:": "}),n(l.span,{style:{color:"#4EC9B0"},children:"string"}),n(l.span,{style:{color:"#D4D4D4"},children:";"})]}),`
`,n(l.span,{class:"line",children:" "}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"  "}),n(l.span,{style:{color:"#569CD6"},children:"constructor"}),n(l.span,{style:{color:"#D4D4D4"},children:"("}),n(l.span,{style:{color:"#9CDCFE"},children:"val"}),n(l.span,{style:{color:"#D4D4D4"},children:": "}),n(l.span,{style:{color:"#4EC9B0"},children:"string"}),n(l.span,{style:{color:"#D4D4D4"},children:") {"})]}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"    "}),n(l.span,{style:{color:"#569CD6"},children:"this"}),n(l.span,{style:{color:"#D4D4D4"},children:"."}),n(l.span,{style:{color:"#9CDCFE"},children:"val"}),n(l.span,{style:{color:"#D4D4D4"},children:" = "}),n(l.span,{style:{color:"#9CDCFE"},children:"val"}),n(l.span,{style:{color:"#D4D4D4"},children:";"})]}),`
`,n(l.span,{class:"line",children:n(l.span,{style:{color:"#D4D4D4"},children:"  }"})}),`
`,n(l.span,{class:"line",children:n(l.span,{style:{color:"#D4D4D4"},children:"}"})}),`
`,n(l.span,{class:"line",children:" "}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#C586C0"},children:"export"}),n(l.span,{style:{color:"#D4D4D4"},children:" "}),n(l.span,{style:{color:"#569CD6"},children:"const"}),n(l.span,{style:{color:"#D4D4D4"},children:" "}),n(l.span,{style:{color:"#4FC1FF"},children:"Greeter"}),n(l.span,{style:{color:"#D4D4D4"},children:" = "}),n(l.span,{style:{color:"#DCDCAA"},children:"component$"}),n(l.span,{style:{color:"#D4D4D4"},children:"(() "}),n(l.span,{style:{color:"#569CD6"},children:"=>"}),n(l.span,{style:{color:"#D4D4D4"},children:" {"})]}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"  "}),n(l.span,{style:{color:"#6A9955"},children:"// BEGIN component serialization boundary"})]}),`
`,n(l.span,{class:"line",children:" "}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"  "}),n(l.span,{style:{color:"#6A9955"},children:"// Referring to top level symbols that are exported is always allowed."})]}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"  "}),n(l.span,{style:{color:"#9CDCFE"},children:"console"}),n(l.span,{style:{color:"#D4D4D4"},children:"."}),n(l.span,{style:{color:"#DCDCAA"},children:"log"}),n(l.span,{style:{color:"#D4D4D4"},children:"("}),n(l.span,{style:{color:"#9CDCFE"},children:"topLevel"}),n(l.span,{style:{color:"#D4D4D4"},children:"); "}),n(l.span,{style:{color:"#6A9955"},children:"// OK"})]}),`
`,n(l.span,{class:"line",children:" "}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"  "}),n(l.span,{style:{color:"#569CD6"},children:"const"}),n(l.span,{style:{color:"#D4D4D4"},children:" "}),n(l.span,{style:{color:"#4FC1FF"},children:"captureSerializable"}),n(l.span,{style:{color:"#D4D4D4"},children:" = "}),n(l.span,{style:{color:"#CE9178"},children:"'serializable data'"}),n(l.span,{style:{color:"#D4D4D4"},children:";"})]}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"  "}),n(l.span,{style:{color:"#569CD6"},children:"const"}),n(l.span,{style:{color:"#D4D4D4"},children:" "}),n(l.span,{style:{color:"#4FC1FF"},children:"capturePromise"}),n(l.span,{style:{color:"#D4D4D4"},children:" = "}),n(l.span,{style:{color:"#4EC9B0"},children:"Promise"}),n(l.span,{style:{color:"#D4D4D4"},children:"."}),n(l.span,{style:{color:"#DCDCAA"},children:"resolve"}),n(l.span,{style:{color:"#D4D4D4"},children:"("}),n(l.span,{style:{color:"#CE9178"},children:"'Qwik serializes promises'"}),n(l.span,{style:{color:"#D4D4D4"},children:");"})]}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"  "}),n(l.span,{style:{color:"#6A9955"},children:"// Instances of custom classes are not serializable."})]}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"  "}),n(l.span,{style:{color:"#569CD6"},children:"const"}),n(l.span,{style:{color:"#D4D4D4"},children:" "}),n(l.span,{style:{color:"#4FC1FF"},children:"captureNonSerializable"}),n(l.span,{style:{color:"#D4D4D4"},children:" = "}),n(l.span,{style:{color:"#569CD6"},children:"new"}),n(l.span,{style:{color:"#D4D4D4"},children:" "}),n(l.span,{style:{color:"#DCDCAA"},children:"MyCustomClass"}),n(l.span,{style:{color:"#D4D4D4"},children:"("}),n(l.span,{style:{color:"#CE9178"},children:"'non serializable'"}),n(l.span,{style:{color:"#D4D4D4"},children:");"})]}),`
`,n(l.span,{class:"line",children:" "}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"  "}),n(l.span,{style:{color:"#C586C0"},children:"return"}),n(l.span,{style:{color:"#D4D4D4"},children:" ("})]}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"    "}),n(l.span,{style:{color:"#808080"},children:"<"}),n(l.span,{style:{color:"#569CD6"},children:"button"})]}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"      "}),n(l.span,{style:{color:"#9CDCFE"},children:"onClick$"}),n(l.span,{style:{color:"#D4D4D4"},children:"="}),n(l.span,{style:{color:"#569CD6"},children:"{"}),n(l.span,{style:{color:"#D4D4D4"},children:"() "}),n(l.span,{style:{color:"#569CD6"},children:"=>"}),n(l.span,{style:{color:"#D4D4D4"},children:" {"})]}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"        "}),n(l.span,{style:{color:"#6A9955"},children:"// BEGIN onClick serialization boundary"})]}),`
`,n(l.span,{class:"line",children:" "}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"        "}),n(l.span,{style:{color:"#6A9955"},children:"// Referring to top level symbols that are exported is always allowed,"})]}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"        "}),n(l.span,{style:{color:"#6A9955"},children:"// even if the value is non-serializable."})]}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"        "}),n(l.span,{style:{color:"#9CDCFE"},children:"console"}),n(l.span,{style:{color:"#D4D4D4"},children:"."}),n(l.span,{style:{color:"#DCDCAA"},children:"log"}),n(l.span,{style:{color:"#D4D4D4"},children:"("}),n(l.span,{style:{color:"#9CDCFE"},children:"topLevel"}),n(l.span,{style:{color:"#D4D4D4"},children:"); "}),n(l.span,{style:{color:"#6A9955"},children:"// OK"})]}),`
`,n(l.span,{class:"line",children:" "}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"        "}),n(l.span,{style:{color:"#6A9955"},children:"// Capturing a non-top-level variable is allowed only if:"})]}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"        "}),n(l.span,{style:{color:"#6A9955"},children:"// - declared as `const`"})]}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"        "}),n(l.span,{style:{color:"#6A9955"},children:"// - is serializable (runtime error)"})]}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"        "}),n(l.span,{style:{color:"#9CDCFE"},children:"console"}),n(l.span,{style:{color:"#D4D4D4"},children:"."}),n(l.span,{style:{color:"#DCDCAA"},children:"log"}),n(l.span,{style:{color:"#D4D4D4"},children:"("}),n(l.span,{style:{color:"#9CDCFE"},children:"captureSerializable"}),n(l.span,{style:{color:"#D4D4D4"},children:"); "}),n(l.span,{style:{color:"#6A9955"},children:"// OK"})]}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"        "}),n(l.span,{style:{color:"#9CDCFE"},children:"console"}),n(l.span,{style:{color:"#D4D4D4"},children:"."}),n(l.span,{style:{color:"#DCDCAA"},children:"log"}),n(l.span,{style:{color:"#D4D4D4"},children:"("}),n(l.span,{style:{color:"#9CDCFE"},children:"capturePromise"}),n(l.span,{style:{color:"#D4D4D4"},children:"); "}),n(l.span,{style:{color:"#6A9955"},children:"// OK"})]}),`
`,n(l.span,{class:"line",children:" "}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"        "}),n(l.span,{style:{color:"#6A9955"},children:"// Referring to captureNonSerializable will pass static analysis but"})]}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"        "}),n(l.span,{style:{color:"#6A9955"},children:"// will fail at runtime because Qwik does not know how to serialize it."})]}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"        "}),n(l.span,{style:{color:"#9CDCFE"},children:"console"}),n(l.span,{style:{color:"#D4D4D4"},children:"."}),n(l.span,{style:{color:"#DCDCAA"},children:"log"}),n(l.span,{style:{color:"#D4D4D4"},children:"("}),n(l.span,{style:{color:"#9CDCFE"},children:"captureNonSerializable"}),n(l.span,{style:{color:"#D4D4D4"},children:"); "}),n(l.span,{style:{color:"#6A9955"},children:"// RUNTIME ERROR"})]}),`
`,n(l.span,{class:"line",children:" "}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"        "}),n(l.span,{style:{color:"#6A9955"},children:"// END onClick serialization boundary"})]}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"      }"}),n(l.span,{style:{color:"#569CD6"},children:"}"})]}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"    "}),n(l.span,{style:{color:"#808080"},children:">"})]}),`
`,n(l.span,{class:"line",children:n(l.span,{style:{color:"#D4D4D4"},children:"      click"})}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"    "}),n(l.span,{style:{color:"#808080"},children:"</"}),n(l.span,{style:{color:"#569CD6"},children:"button"}),n(l.span,{style:{color:"#808080"},children:">"})]}),`
`,n(l.span,{class:"line",children:n(l.span,{style:{color:"#D4D4D4"},children:"  );"})}),`
`,n(l.span,{class:"line",children:[n(l.span,{style:{color:"#D4D4D4"},children:"  "}),n(l.span,{style:{color:"#6A9955"},children:"// END component serialization boundary"})]}),`
`,n(l.span,{class:"line",children:n(l.span,{style:{color:"#D4D4D4"},children:"});"})})]})})})]})}function a(e={}){const{wrapper:l}=e.components||{};return l?n(l,Object.assign({},e,{children:n(r,e)})):r(e)}const p=()=>s(c,{children:s(a,{},3,null)},3,"75N057Oo");export{p as default,d as frontmatter,D as head,t as headings};
